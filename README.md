# Проект Hackathon

Этот проект состоит из Telegram-бота, бэкенд-сервиса и агента для работы с файловой системой, предназначенных для управления загрузкой и получением файлов. Проект был протестирован на ноутбуке и сервере, где запросы корректно обрабатывались, файлы передавались и появлялись на сервере. Однако, из-за проблем с контейнером на C++, поддержка Docker еще не была полностью реализована.

## Архитектура проекта

### 1. Бот на Telethon
Бот построен на библиотеке Telethon и взаимодействует с пользователями через набор команд и кнопок.

- **Команда `/start`**:
  - При получении команды старт от пользователя, бот проверяет, находится ли его ID в вайтлисте.
  - Если пользователь находится в вайтлисте, выводится форма с двумя кнопками: "Получить ссылки" и "Загрузить файл".
  - Эти кнопки формируют запросы на бэкенд-API.

### 2. Бэкенд на FastAPI
Бэкенд реализован на FastAPI и содержит следующие роуты:

1. **Добавление пользователя в базу данных**:
   - Проверяет, присутствует ли пользователь уже в базе данных, и добавляет его, если нет.

2. **Создание файла**:
   - Формирует HTTP-запрос на агента, который принимает файл и сохраняет его по переданному пути.
   - Агент возвращает ссылку на файл вида: `http://address:8056/file?f=link`. При открытии этой ссылки файл должен скачиваться (реализация на стороне агента).

3. **Получение списка файлов и их ссылок**:
   - Возвращает список ссылок и названий оригинальных файлов из папки и базы данных. Бот отправляет полученный список пользователю.

4. **Запрос для агента нахождения имени файла по уникальной части ссылки**:
   - Возвращает название оригинального файла по уникальной части ссылки.

### 3. База данных
[Структура базы данных](https://imgur.com/a/mebnNcq)

## Что бы хотелось сделать, но не успелось или не сложилось

1. **Реализовать и проверить работу загрузки файлов по ссылке**.
   - Эта часть функционала еще не проверена.

2. **Победить Docker**:
   - Завершить настройку и завернуть все в `docker-compose`.

3. **Поправить вайтлист у бота**:
   - Исправить проблему, при которой кнопки остаются активными в чате после удаления пользователя из вайтлиста.

4. **Добавить больше логирования**:
   - Улучшить логирование и обернуть все "опасные" места в `try-except`.

5. **Переорганизовать базу данных**:
   - Пересмотреть и улучшить структуру отношений в базе данных.
